{"ts":1360725249549,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"google-auth-serviceAccount\n==========================\nMotivation:\n------------------------\n\nWanted to accesss my personal calendar, NOT the one of Google Apps, and found no good example for node.js with [service account][3] without any interaction.\n\nPreparation:\n------------------------\n1.  Create your service account and enable calendar access(thanks to [this post][1]):\n<pre>\n>    a) Log in into the Google account you want to use to manage your projects.\n>    b) Go to https://code.google.com/apis/console/\n>    c) Create a project. You will get issued a project number, in our example\n>    we'll use 99999999999.\n>    d) Allow the project to use the calendar API:\n>    -> services (left pane), then find 'calendar api' and set the button 'on'\n>    e) Create a Service Account.\n>    -> API access (left pane); select 'create service account'\n>    Part of the procedure is that you'll get a PKCS#12 bundle, which you can\n>    download and should store on your appserver in a secure location. Your\n>    app should be able to access it, but outsiders should not be allowed to\n>    download it.\n</pre>\n2.  Store the p12 file into pem with openssl(thank [this][2])\n\n    $ openssl pkcs12 -in yourkey.p12 -out yourkey.pem -nodes<br/>\n    type \"notasecret\" for password.\n\n3.  Install dependencies\n\n    $ npm install crypto request nconf\n\n4.  Share the calendar with your developer account\n\n    Calendar \"Settings\" -> \"Share this calendar\", at \"Share with specific people\",\n    put the email address of developer account choosing a permission you want, then \"add person\".\n    The address should be like \"yourProjectId@developer.gserviceaccount.com\".\n\n5.  Edit config.json and place key.pem which generated in step 2.\n<pre>\n    {\n     \"keyFile\": \"key.pem\"\n    ,\"expiresInMinuteas\": 60\n    ,\"claim\":{\n    \t \"iss\":\"yourProjectID@developer.gserviceaccount.com\"\n    \t,\"scope\":\"https://www.googleapis.com/auth/calendar\"\n    \t,\"aud\":\"https://accounts.google.com/o/oauth2/token\"\n     }\n    }\n</pre>\n\n6.  Test with test.js.\n\n    if successfull, you'll see an access token:\n    <pre>token:ya29.AHES6ZSfxRWLEv9vfusipvawSS-55oQyMAGxF3kbRGsgGMTo</pre>\n\n7.  Enjoy with [calendar APIs][4]. You may try listEvents.js.\n\n[1]: https://groups.google.com/forum/?fromgroups=#!topic/google-calendar-api/MySzyAXq12Q\n[2]: http://stackoverflow.com/questions/11529595/is-a-service-account-the-right-credentials-for-querying-google-bigquery-in-node\n[3]: https://developers.google.com/accounts/docs/OAuth2ServiceAccount\n[4]: https://developers.google.com/google-apps/calendar/v3/reference\n\nUsage example:\n------------------------\n`````javascript\nconst request = require('request');\nconst gaccount = require('./google-serviceaccount');\n\nconst calRoot = \"https://www.googleapis.com/calendar/v3\";\n\ngaccount.auth(function(err, access_token){\n\n    var token = \"?access_token=\"+access_token;\n\n    request.get({\n        url:calRoot+\"/users/me/calendarList\"+token,\n        json:true\n        }, function(err, res, body){\n\n            for(var c=0; c<body.items.length; c++){\n                console.log(body.items[c]);\n\n                request.get({\n                    url:calRoot+\"/calendars/\"+body.items[c].id+\"/events\"+token,\n                    json:true\n                    }, function(err, res, cal){\n                        console.log(cal);\n                });\n            }\n    })\n\n});\n`````\n"]],"start1":0,"start2":0,"length1":0,"length2":3359}]],"length":3359}
{"contributors":[],"silentsave":false,"ts":1360725262815,"patch":[[{"diffs":[[0,"/google-"],[1,"oauth-"],[0,"servicea"]],"start1":2676,"start2":2676,"length1":16,"length2":22}]],"length":3365,"saved":false}
{"ts":1360725299678,"patch":[[{"diffs":[[0,".  Edit "],[1,"oahtu-"],[0,"config.j"]],"start1":1648,"start2":1648,"length1":16,"length2":22}]],"length":3371,"saved":false}
{"ts":1360725327224,"patch":[[{"diffs":[[0,"\n\n3."],[-1,"  Install dependencies\n\n    $ npm install crypto request nconf\n\n4."],[0,"  Sh"]],"start1":1267,"start2":1267,"length1":74,"length2":8},{"diffs":[[0,"account\n"],[1,""],[0,"\n    Cal"]],"start1":1312,"start2":1312,"length1":16,"length2":16},{"diffs":[[0,".com\".\n\n"],[-1,"5"],[1,"4"],[0,".  Edit "]],"start1":1573,"start2":1573,"length1":17,"length2":17},{"diffs":[[0,"</pre>\n\n"],[-1,"6"],[1,"5"],[0,".  Test "]],"start1":1920,"start2":1920,"length1":17,"length2":17},{"diffs":[[0,"e>\n\n"],[-1,"7"],[1,"6"],[0,".  E"]],"start1":2072,"start2":2072,"length1":9,"length2":9}]],"length":3305,"saved":false}
{"ts":1360725492606,"patch":[[{"diffs":[[0,"auth-service"],[-1,"A"],[1,"a"],[0,"ccount\n====="]],"start1":7,"start2":7,"length1":25,"length2":25},{"diffs":[[0,"ction.\n\n"],[1,"Install:\n------------------------\n\n    npm install google-auth-serviceaccount\n\n"],[0,"Preparat"]],"start1":242,"start2":242,"length1":16,"length2":95}]],"length":3384,"saved":false}
{"ts":1360725515543,"patch":[[{"diffs":[[0,"google-"],[1,"o"],[0,"auth-serviceaccount\n===="]],"start1":0,"start2":0,"length1":31,"length2":32},{"diffs":[[0," google-"],[1,"o"],[0,"auth-ser"]],"start1":301,"start2":301,"length1":16,"length2":17}]],"length":3386,"saved":false}
